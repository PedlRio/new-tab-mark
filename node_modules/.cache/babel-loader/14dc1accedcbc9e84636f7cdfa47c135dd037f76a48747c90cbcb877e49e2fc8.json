{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport { defineComponent } from 'vue';\nimport { Editor, EditorContent } from '@tiptap/vue-2';\nimport Document from '@tiptap/extension-document';\nimport Heading from '@tiptap/extension-heading';\nimport Paragraph from '@tiptap/extension-paragraph';\nimport Text from '@tiptap/extension-text';\nimport StarterKit from '@tiptap/starter-kit';\nimport Typography from '@tiptap/extension-typography';\nimport Highlight from '@tiptap/extension-highlight';\nimport TaskItem from '@tiptap/extension-task-item';\nimport TaskList from '@tiptap/extension-task-list';\nimport FileHandler from '@tiptap-pro/extension-file-handler';\nimport Image from '@tiptap/extension-image';\nexport default defineComponent({\n  components: {\n    EditorContent\n  },\n  data() {\n    return {\n      editor: null\n    };\n  },\n  mounted() {\n    this.initializeEditor();\n    this.loadContent();\n  },\n  methods: {\n    initializeEditor() {\n      this.editor = new Editor({\n        extensions: [Document, Heading, Paragraph, Text, StarterKit, Typography, Highlight, TaskItem, TaskList, Image, FileHandler.configure({\n          allowedMimeTypes: ['image/png', 'image/jpeg', 'image/gif', 'image/webp'],\n          onDrop: this.handleFileDrop,\n          onPaste: this.handleFilePaste\n        })],\n        content: localStorage.getItem('editorContent') || `\n                  <h1>\n                      Try to paste or drop files into this editor\n                  </h1>\n                  <p></p>\n                  <p></p>\n                  <p></p>\n                  <p></p>\n                  <p></p>\n              `,\n        onBlur: () => this.saveContent()\n      });\n    },\n    saveContent() {\n      const content = this.editor.getHTML();\n      localStorage.setItem('editorContent', content);\n    },\n    loadContent() {\n      const savedContent = localStorage.getItem('editorContent');\n      if (savedContent) {\n        this.editor.commands.setContent(savedContent);\n      }\n    },\n    handleFileDrop(currentEditor, files, pos) {\n      files.forEach(file => {\n        const reader = new FileReader();\n        reader.onload = event => {\n          const dataUrl = event.target.result;\n          this.saveImageToChromeStorage(file.name, dataUrl);\n          currentEditor.chain().insertContentAt(pos, {\n            type: 'image',\n            attrs: {\n              src: dataUrl\n            }\n          }).focus().run();\n        };\n        reader.readAsDataURL(file);\n      });\n    },\n    handleFilePaste(currentEditor, files) {\n      files.forEach(file => {\n        const reader = new FileReader();\n        reader.onload = event => {\n          const dataUrl = event.target.result;\n          this.saveImageToChromeStorage(file.name, dataUrl);\n          currentEditor.chain().insertContentAt(currentEditor.state.selection.anchor, {\n            type: 'image',\n            attrs: {\n              src: dataUrl\n            }\n          }).focus().run();\n        };\n        reader.readAsDataURL(file);\n      });\n    },\n    saveImageToChromeStorage(name, dataUrl) {\n      const blob = this.dataURLToBlob(dataUrl);\n      const url = URL.createObjectURL(blob);\n      chrome.storage.local.set({\n        [name]: url\n      }, () => {\n        URL.revokeObjectURL(url);\n      });\n    },\n    dataURLToBlob(dataUrl) {\n      const arr = dataUrl.split(',');\n      const mime = arr[0].match(/:(.*?);/)[1];\n      const bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], {\n        type: mime\n      });\n    }\n  },\n  beforeUnmount() {\n    this.editor.destroy();\n  }\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}